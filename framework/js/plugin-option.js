!function(a){"use strict";var b=function(){this.main_nav=a("#tourmaster-admin-option-nav"),this.nav_slide=a("#tourmaster-admin-option-nav-slides"),this.breadcrumbs=a("#tourmaster-admin-option-head-breadcrumbs"),this.current_active_nav=this.main_nav.children(".tourmaster-active"),this.sub_nav=a("#tourmaster-admin-option-subnav"),this.content=a("#tourmaster-admin-option-body-content"),this.search_btn=a("#tourmaster-admin-option-head-search-button"),this.search_txt=a("#tourmaster-admin-option-head-search-text"),this.save_btn=a("#tourmaster-admin-option-save-button"),this.html_option=new tourmasterHtmlOption(this.content),this.init()};b.prototype={init:function(){var b=this;b.mainNavBinding(),b.slideNavBinding(),b.subNavBinding(),b.saveBtnBinding(),b.search_btn.click(function(){var c=b.search_txt.val();""==c.trim()?tourmaster_alert_box({status:"failed",head:a(this).attr("data-blank-keyword-head"),message:a(this).attr("data-blank-keyword")}):b.searchAction(c)}),b.search_txt.on("input",tourmaster_debounce(function(){var a=b.search_txt.val();""==a.trim()?b.current_active_nav.trigger("click"):b.searchAction(a)},600))},ajax_action:function(b){var c=this,d=a.extend({beforeSend:function(){c.content.children(".tourmaster-active").animate({opacity:0},150,function(){c.content.addClass("tourmaster-now-loading")})},error:function(a,b,d){tourmaster_alert_box({status:"failed",head:tourmaster_ajax_message.error_head,message:tourmaster_ajax_message.error_message}),console.log(a,b,d),c.content.removeClass("tourmaster-now-loading"),c.content.children(".tourmaster-active").animate({opacity:1},150)},success:function(a){"failed"==a.status?tourmaster_alert_box({status:a.status,head:a.head,message:a.message}):"success"==a.status&&(c.breadcrumbs.html(a.breadcrumbs),c.sub_nav.html(a.subnav),c.content.html(a.content).removeClass("tourmaster-now-loading"),c.content.children(".tourmaster-active").css({opacity:0}).animate({opacity:1},200),c.html_option.rebind(),c.content.find(".tourmaster-admin-option-save-button").click(function(){c.save_btn.trigger("click")}))}},b);a.ajax({type:"POST",url:tourmaster_ajax_message.ajaxurl,data:d.data,dataType:"json",beforeSend:d.beforeSend,error:d.error,success:d.success})},mainNavBinding:function(){var b=this;b.main_nav.children(".tourmaster-admin-option-nav-item").click(function(){a(this).hasClass("tourmaster-active")||(b.current_active_nav=a(this),b.current_active_nav.addClass("tourmaster-active").siblings().removeClass("tourmaster-active"),b.current_active_nav.trigger("tourmaster-active-changed"),b.ajax_action({data:{security:tourmaster_ajax_message.nonce,action:"get_tourmaster_option_tab",nav_order:a(this).attr("data-nav-order"),option:b.html_option.get_val()}}))})},searchAction:function(a){var b=this;b.ajax_action({data:{security:tourmaster_ajax_message.nonce,action:"get_tourmaster_option_search",keyword:a,option:b.html_option.get_val()},beforeSend:function(){b.main_nav.trigger("tourmaster-active-none"),b.content.children(".tourmaster-active").animate({opacity:0},150,function(){b.content.addClass("tourmaster-now-loading")})}})},slideNavBinding:function(){var b=this,c=b.main_nav.children(".tourmaster-admin-option-nav-item.tourmaster-active"),d={left:c.length>0?c.position().left:0,width:c.length>0?c.width():0};b.nav_slide.css({left:d.left,width:d.width}),b.main_nav.children(".tourmaster-admin-option-nav-item").hover(function(){b.nav_slide.animate({left:a(this).position().left,width:a(this).width()},{queue:!1,easing:"easeOutQuad",duration:250})},function(){b.nav_slide.animate({left:d.left,width:d.width},{queue:!1,easing:"easeOutQuad",duration:250})}),b.main_nav.children(".tourmaster-admin-option-nav-item").on("tourmaster-active-changed",function(){d.left=a(this).position().left,d.width=a(this).width(),b.nav_slide.css({left:d.left,width:d.width})}),b.main_nav.on("tourmaster-active-none",function(){d.left=0,d.width=0,b.nav_slide.css({left:d.left,width:d.width}),b.current_active_nav.removeClass("tourmaster-active")})},subNavBinding:function(){var b=this;b.sub_nav.on("click",".tourmaster-admin-option-subnav-item",function(){if(!a(this).hasClass("tourmaster-active")){a(this).addClass("tourmaster-active").siblings(".tourmaster-active").removeClass("tourmaster-active");var c=a(this).attr("data-subnav-slug"),d=a(this).html();b.content.children(".tourmaster-admin-option-section").each(function(){c==a(this).attr("data-section-slug")?(a(this).css({display:"none"}).addClass("tourmaster-active").fadeIn(200),b.breadcrumbs.children(".tourmaster-admin-option-head-breadcrumbs-subnav").html(d).css("opacity",0).animate({opacity:1},100)):a(this).removeClass("tourmaster-active").css({display:"none"})})}})},saveBtnBinding:function(){var a=this;a.save_btn.click(function(){a.save_btn.addClass("tourmaster-now-loading"),a.content.find(".tourmaster-admin-option-save-button").addClass("tourmaster-now-loading"),a.ajax_action({beforeSend:function(){a.save_btn.addClass("tourmaster-now-loading")},data:{security:tourmaster_ajax_message.nonce,action:"save_tourmaster_option",option:a.html_option.get_val()},success:function(b){"failed"==b.status?tourmaster_alert_box({status:b.status,head:b.head,message:b.message}):"success"==b.status&&tourmaster_alert_box({status:b.status,head:b.head,message:b.message}),a.save_btn.removeClass("tourmaster-now-loading"),a.content.find(".tourmaster-admin-option-save-button").removeClass("tourmaster-now-loading")}})}),a.content.find(".tourmaster-admin-option-save-button").click(function(){a.save_btn.trigger("click")})}},a(document).ready(function(){new b})}(jQuery);